<!doctype html>
<html>
<body>
<h1>third party site (with iframe)</h1>

<!-- Start of Boomerang Widget script -->
<script>

  const iframeElement = document.createElement("iframe");
  iframeElement.id="boomerangIframe";
  iframeElement.scrolling="no";
  iframeElement.frameBorder="0";
  iframeElement.allowtransparency="false";
  iframeElement.title="";
  iframeElement.width = "310px";
  iframeElement.height = "100px";

  const cssStyle = "z-index: 999999; position: fixed; bottom: 0; left: 0; margin-left: 100px;";

  (iframeElement.frameElement||iframeElement).style.cssText=cssStyle;

  // const containerDiv = document.createElement("div");
  // containerDiv.style.visibility = "visible";
  // containerDiv.appendChild(iframeElement);
  // document.body.appendChild(containerDiv);

  document.body.appendChild(iframeElement);

  const boomerangIframeDocument = document.getElementById("boomerangIframe").contentWindow.document;
  boomerangIframeDocument.open();

  boomerangIframeDocument._l=function() {

    const mainDiv = this.createElement("div");
    mainDiv.id = "content";
    this.body.appendChild(mainDiv);

    const mainScript = this.createElement("script");

    const code = "(function(d, s, id){      var js, fjs = d.getElementsByTagName(s)[0];      if (d.getElementById(id)){ return; }      js = d.createElement(s); js.id = id;      js.onload = function(){        boomerangApp.rateExperience('Sharoda', 'mySignature', d.getElementById(\"content\"));      };      js.src = \"https://s3.amazonaws.com/boomerang-webplugin/boomerangWebPluginWidget.js\";      fjs.parentNode.insertBefore(js, fjs);  }(document, 'script', 'boomerangWebPlugin'));";

    try {
      mainScript.appendChild(this.createTextNode(code));
    } catch (e) {
      mainScript.text = code;
    }

    this.body.appendChild(mainScript);
  };

  boomerangIframeDocument.write('<body style="margin:0; padding:0" onload="document._l();">');
  boomerangIframeDocument.close();

  const boomerang = document.getElementById("boomerangIframe").contentWindow;

  boomerang.show = function() {
    containerDiv.style.visibility = "visible";
  };

  boomerang.hide = function() {
    containerDiv.style.visibility = "hidden";
  };

  boomerang.isVisible = function() {
    return containerDiv.style.visibility === "visible";
  };

</script>
<!-- End of Boomerang Widget script -->
</body>
</html>


