<!doctype html>
<html>
<body>
<h1>third party site (with iframe)</h1>

<!-- Start of Kudos Widget script -->
<script>

  const iframeElement = document.createElement("iframe");
  iframeElement.id="kudosIframe";
  iframeElement.scrolling="no";
  iframeElement.frameBorder="0";
  iframeElement.allowtransparency="false";
  iframeElement.title="";

  const cssStyle = "z-index: 999999; width: 260px; opacity: 1; height: 410px; position: fixed; bottom: 0; right: 0; margin: 5px;";

  (iframeElement.frameElement||iframeElement).style.cssText=cssStyle;

  const containerDiv = document.createElement("div");
  containerDiv.style.visibility = "visible";
  containerDiv.appendChild(iframeElement);
  document.body.appendChild(containerDiv);

  const kudosIframeDocument = document.getElementById("kudosIframe").contentWindow.document;
  kudosIframeDocument.open();

  kudosIframeDocument._l=function() {

    const mainDiv = this.createElement("div");
    mainDiv.style = "max-width: 600px";
    mainDiv.id = "content";
    this.body.appendChild(mainDiv);

    const mainScript = this.createElement("script");

    const code = "(function(d, s, id){      var js, fjs = d.getElementsByTagName(s)[0];      if (d.getElementById(id)){ return; }      js = d.createElement(s); js.id = id;      js.onload = function(){        showWidget(d.getElementById(\"content\"));      };      js.src = \"https://s3.amazonaws.com/kudos-webplugin/kudosWebPluginWidget.js\";      fjs.parentNode.insertBefore(js, fjs);  }(document, 'script', 'kudosWebPlugin'));";

    try {
      mainScript.appendChild(this.createTextNode(code));
    } catch (e) {
      mainScript.text = code;
    }

    this.body.appendChild(mainScript);
  };

  kudosIframeDocument.write('<body onload="document._l();">');
  kudosIframeDocument.close();

  const kudos = kudosIframeDocument;

  kudos.show = function() {
    containerDiv.style.visibility = "visible";
  };

  kudos.hide = function() {
    containerDiv.style.visibility = "hidden";
  };

  kudos.isVisible = function() {
    return containerDiv.style.visibility === "visible";
  };

</script>
<!-- End of Kudos Widget script -->
</body>
</html>


