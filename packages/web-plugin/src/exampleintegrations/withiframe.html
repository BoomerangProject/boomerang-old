<!doctype html>
<html>
<body>
<h1>third party site</h1>

<!-- Start of Kudos Widget script -->
<script>

  var iframeElement = document.createElement("iframe");
  iframeElement.id="kudosIframe";
  iframeElement.scrolling="no";
  iframeElement.frameBorder="0";
  iframeElement.allowtransparency="false";
  iframeElement.title="";

  // TODO fix this
  // iframeElement.src = 'javascript:var d=document.open();d.domain="'+document.domain+'";void(0);';

  var cssStyle = "z-index: 999999; width: 260px; opacity: 1; height: 410px; position: fixed; bottom: 0; right: 0; margin: 5px;";

  (iframeElement.frameElement||iframeElement).style.cssText=cssStyle;

  var containerDiv = document.createElement("div");
  containerDiv.appendChild(iframeElement);
  document.body.appendChild(containerDiv);

  var kudosIframeDocument = document.getElementById("kudosIframe").contentWindow.document;

  kudosIframeDocument.open();

  kudosIframeDocument._l=function() {

    var mainDiv = this.createElement("div");
    mainDiv.style = "max-width: 600px";
    mainDiv.id = "content";
    this.body.appendChild(mainDiv);

    var mainScript = this.createElement("script");

    var code = "(function(d, s, id){      var js, fjs = d.getElementsByTagName(s)[0];      if (d.getElementById(id)){ return; }      js = d.createElement(s); js.id = id;      js.onload = function(){        showWidget(d.getElementById(\"content\"));      };      js.src = \"https://s3.amazonaws.com/kudos-webplugin/kudosWebPluginWidget.js\";      fjs.parentNode.insertBefore(js, fjs);  }(document, 'script', 'kudosWebPlugin'));";

    try {
      mainScript.appendChild(this.createTextNode(code));
    } catch (e) {
      mainScript.text = code;
    }

    this.body.appendChild(mainScript);
  };

  kudosIframeDocument.write('<body onload="document._l();">');
  kudosIframeDocument.close()
</script>
<!-- End of Kudos Widget script -->
</body>
</html>


